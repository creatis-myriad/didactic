# @package _global_

defaults:
  - cardinal/cardiac-multimodal-representation
  - /callbacks:
      - transformer_encoder_freeze
  - /task/constraint: ???

trainer:
  max_epochs: 500

excluded_clinical_attrs: ${oc.dict.keys:task.predict_losses}

task:
  predict_losses: ???
  constraint_weight: 1
  attrs_dropout: [0.1, 0]

callbacks:
  transformer_encoder_freeze:
    finetune_layers: null

# Change checkpoint loading defaults to:
ckpt: ??? # Make it mandatory to provide a checkpoint
weights_only: True  # Only load the weights and ignore the hyperparameters
strict: False # Only load weights where they match the defined network, to only some changes (e.g. heads, etc.)

hydra:
  run:
    dir: ${oc.env:CARDIAC_MULTIMODAL_REPR_PATH}/finetune+constraint/constraint=${hydra:runtime.choices.task/constraint}/targets=${oc.dict.keys:task.predict_losses}/${experiment_dirname}/${hydra.job.override_dirname}
  sweep:
    dir: ${oc.env:CARDIAC_MULTIMODAL_REPR_PATH}/finetune+constraint
    subdir: constraint=${hydra:runtime.choices.task/constraint}/targets=${oc.dict.keys:task.predict_losses}/${experiment_dirname}/${hydra.job.override_dirname}
